(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e9be22d"],{2217:function(t,e,a){"use strict";a("3dcc")},"3dcc":function(t,e,a){},"8e8c":function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"f",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"c",(function(){return u}));var n=a("b775"),i=function(t){return Object(n["a"])("GET","/dapp/information/getInformationAdminIndex",t,!0,!0,1)},r=function(t){return Object(n["a"])("GET","/dapp/information/adminList",t)},o=function(t){return Object(n["a"])("GET","/dapp/information/list",t,!0,!0)},s=function(t){return Object(n["a"])("POST","/dapp/information",t)},c=function(t){return Object(n["a"])("GET","/dapp/information/".concat(t),t,!0,!0)},l=function(t){return Object(n["a"])("PUT","/dapp/information",t)},u=function(t){return Object(n["a"])("DELETE","/dapp/information/".concat(t))}},a261:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a("b775"),i=function(t){return Object(n["a"])("POST","/dapp/oss/upload",t,!0,!0)}},a527:function(t,e,a){},b0c0:function(t,e,a){var n=a("83ab"),i=a("5e77").EXISTS,r=a("e330"),o=a("9bf2").f,s=Function.prototype,c=r(s.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=r(l.exec),d="name";n&&!i&&o(s,d,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(t){return""}}})},bb01:function(t,e,a){"use strict";a("a527")},f073:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"release-wrap"},[a("van-field",{staticClass:"title-wrap",attrs:{rows:"2",autosize:"",type:"textarea",translate:"no",maxlength:"50",placeholder:t.$t("common.inputTitle"),"show-word-limit":""},model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}}),a("div",{staticClass:"set-image"},[a("div",{staticClass:"name"},[t._v(t._s(t.$t("admin.setPreview")))]),a("van-uploader",{attrs:{"after-read":t.afterRead},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}},[a("div",{staticClass:"upload"},[a("van-icon",{staticClass:"icon",attrs:{name:"plus",size:"25"}})],1)])],1),a("div",{staticClass:"editor",attrs:{translate:"no"}},[a("Editor",{attrs:{height:"440"},model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}})],1),a("div",{staticClass:"icon-group"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.dataForm.isImportant,expression:"!dataForm.isImportant"}],staticClass:"icon-normal",on:{click:t.handleIsImportant}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.dataForm.isImportant,expression:"dataForm.isImportant"}],staticClass:"icon-select",on:{click:t.handleIsImportant}},[a("div",{staticClass:"dot"})]),a("span",[t._v(t._s(t.$t("admin.important")))])]),a("div",{staticClass:"button",on:{click:t.handleAddNews}},[t._v(t._s(t.$t("admin.release")))])],1)},i=[],r=a("5530"),o=a("1da1"),s=(a("96cf"),a("f645")),c=a("8e8c"),l=a("a261"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("quill-editor",{ref:"myTextEditor",staticClass:"editorBox",style:{height:t.height+"px",marginBottom:t.marginB+"px"},attrs:{options:t.editorOption,disabled:t.disabled},on:{change:function(e){return t.onEditorChange(e)}},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}}),a("div",{staticStyle:{"text-align":"right","font-size":"12px"}},[t._v(" "+t._s(t.TiLength)+"/"+t._s(t.limit)+" ")])],1)},d=[],m=(a("a9e3"),a("d3b7"),a("ac1f"),a("466d"),a("b0c0"),a("953d")),p=(a("a753"),a("8096"),a("14e1"),a("e7e5"),a("d399")),f={action:s["a"].server+"/dapp/oss/upload",methods:"POST",name:"file",size:2e3,accept:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},h=[["bold","italic","underline","strike"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["link","image"]],g={image:function(){var t=this,e=this.container.querySelector("input.ql-image[type=file]");null===e&&(e=document.createElement("input"),e.setAttribute("type","file"),f.name&&e.setAttribute("name",f.name),e.setAttribute("accept",f.accept),e.classList.add("ql-image"),e.addEventListener("change",(function(){var a=new FormData;a.append(f.name,e.files[0]);var n=new XMLHttpRequest;n.open(f.methods,f.action,!0),n.onload=function(a){if(200===n.status){a=JSON.parse(n.responseText);var i=t.quill.getSelection(!0).index;t.quill.insertEmbed(i,"image",s["a"].imgUrl+a.data.url),t.quill.setSelection(i+1)}e.value=""},n.upload.onloadstart=function(t){e.value=""},n.upload.onerror=function(t){p["a"].error({message:"图片上传失败"})},n.upload.onloadend=function(t){},n.send(a)})),this.container.appendChild(e)),e.click()}},b={placeholder:"",modules:{toolbar:{container:h,handlers:g}}},v={components:{},props:{value:String,height:{type:[Number,String],default:240},marginB:{type:[Number,String],default:10},disabled:{type:Boolean,default:!1},limit:{type:Number,default:4e3}},model:{prop:"value",event:"change"},data:function(){return{data:"",editorOption:b,TiLength:0}},computed:{},created:function(){},watch:{value:{handler:function(t){t&&(this.data=t)},deep:!0,immediate:!0},data:function(t){this.$emit("change",t)},disabled:{handler:function(t){t&&this.$nextTick((function(){var t=document.getElementsByClassName("editorBox")[0],e=document.getElementsByClassName("ql-toolbar")[0];t.removeChild(e)}))},deep:!0,immediate:!0}},methods:{init:function(){var t=this,e=this.$refs.myTextEditor.quill;e.root.addEventListener("paste",(function(e){e.clipboardData&&e.clipboardData.files&&e.clipboardData.files.length&&(e.preventDefault(),[].forEach.call(e.clipboardData.files,(function(e){e.type.match(/^image\/(gif|jpe?g|a?png|bmp)/i)&&t.uploadToServer(e)})))}),!1)},uploadToServer:function(t){var e={action:s["a"].server+"/dapp/oss/upload",methods:"POST",name:"file"},a=new XMLHttpRequest,n=new FormData;n.append(e.name,t),a.open(e.methods,e.action,!0),a.setRequestHeader("Authorization",e.token),a.send(n);var i=this.$refs.myTextEditor.quill;a.onload=function(t){if(200===a.status){t=JSON.parse(a.responseText);var e=i.getSelection(!0).index;i.insertEmbed(e,"image",s["a"].imgUrl+t.data.url),i.setSelection(e+1)}},a.upload.onerror=function(t){this.$message.error("图片上传失败")}},onEditorChange:function(t){t.quill.deleteText(this.limit,1),0===this.value?this.TiLength=0:this.TiLength=t.quill.getLength()-1}},mounted:function(){this.init(),this.TiLength=this.$refs.myTextEditor.quill.getLength()-1;var t=m["Quill"].import("attributors/style/size");t.whitelist=["13px","16px","18px","20px","30px","40px","50px","60px"],m["Quill"].register(t,!0);var e=m["Quill"].import("attributors/style/font"),a=[!1,"Microsoft-YaHei","SimSun","SimHei","KaiTi","FangSong"];e.whitelist=a,m["Quill"].register(e,!0)}},x=v,w=(a("2217"),a("2877")),T=Object(w["a"])(x,u,d,!1,null,"6eab2cdf",null),F=T.exports,E=[["image"]],O={name:"",data:function(){return{title:"",fileList:[],dataForm:{title:"",content:null,type:1,preview:"",isImportant:0},editorOption:{modules:{toolbar:E},theme:"snow",placeholder:""}}},methods:{handleIsImportant:function(){this.dataForm.isImportant=0===this.dataForm.isImportant?1:0},onEditorChange:function(t){t.editor,t.html,t.text;console.log(123)},afterRead:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=new FormData,n.append("file",t.file),a.next=4,Object(l["a"])(n);case 4:if(i=a.sent,i.success){a.next=8;break}return e.fileList=[],a.abrupt("return");case 8:e.dataForm.preview=s["a"].imgUrl+i.data.url,console.log(e.fileList);case 10:case"end":return a.stop()}}),a)})))()},handleAddNews:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.dataForm.content&&t.dataForm.title&&t.dataForm.preview){e.next=2;break}return e.abrupt("return",t.$toast(t.$t("common.fill")));case 2:if(!t.$route.query.id){e.next=8;break}return e.next=5,Object(c["d"])(t.dataForm);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,Object(c["a"])(t.dataForm);case 10:a=e.sent;case 11:if(a.success){e.next=13;break}return e.abrupt("return");case 13:t.$gbUtils.handleToPage("/mediaAdmin");case 14:case"end":return e.stop()}}),e)})))()},getDetail:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["f"])(t);case 2:if(n=a.sent,n.success){a.next=5;break}return a.abrupt("return");case 5:e.dataForm=Object(r["a"])({},n.data),console.log("this.dataForm",e.dataForm),e.fileList.push({url:e.dataForm.preview});case 8:case"end":return a.stop()}}),a)})))()}},mounted:function(){this.$route.query.id&&this.getDetail(this.$route.query.id)},components:{Editor:F}},k=O,y=(a("bb01"),Object(w["a"])(k,n,i,!1,null,"3085d2d2",null));e["default"]=y.exports}}]);
//# sourceMappingURL=chunk-6e9be22d.72474510.js.map