{"version":3,"sources":["webpack:///./src/views/proposal/ModifyProposal.vue?7573","webpack:///src/views/proposal/ModifyProposal.vue","webpack:///./src/views/proposal/ModifyProposal.vue?e121","webpack:///./src/views/proposal/ModifyProposal.vue","webpack:///./src/views/proposal/ModifyProposal.vue?85ba"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","proposalInfo","isCouncil","tokenInfo","tokenAuth","loadingApprove","loadingAdd","on","approveToken","handleAdd","staticRenderFns","name","components","ProposalForm","data","point","daoAt","totalSupply","tokenAddress","computed","mapState","methods","init","getInfo","console","getIsCouncil","daoObj","resp","getTokenInfo","getSymbol","tokenObj","getTotalSupply","getTokenAllance","allowanceAmount","params1","params2","mutilOption","options","mounted","beforeDestroy","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,eAAe,CAACG,MAAM,CAAC,QAAS,EAAK,WAAaP,EAAIQ,aAAa,UAAYR,EAAIS,UAAU,UAAYT,EAAIU,UAAU,UAAYV,EAAIW,UAAU,eAAiBX,EAAIY,eAAe,WAAaZ,EAAIa,YAAYC,GAAG,CAAC,aAAed,EAAIe,aAAa,YAAcf,EAAIgB,cAAc,IACpZC,EAAkB,G,gICqBP,GACfC,QACAC,YAAAC,qBACAC,KAHA,WAIA,OACAC,WACAC,SACAd,aACAD,gBACAE,WACAQ,SACAM,cACAC,iBAEAd,aACAC,kBACAC,gBAGAa,2BACAC,oCAEAC,SACAC,KADA,WAEA,gBAEAC,QAJA,WAIA,oJACAC,+CAEA,+CACA,gCACA,6BACA,kCACA,8CACA,iBACA,iBATA,8CAWAC,aAfA,WAeA,0KACAC,0BADA,UACAC,EADA,OAEAA,UAFA,iDAGA,SACA,eADA,eAHA,8CAMAC,aArBA,WAqBA,2JACA,cADA,SAEA,mBAFA,OAGA,oBAHA,8CAKAC,UA1BA,WA0BA,0KACAC,2CADA,UACAH,EADA,OAEAA,UAFA,iDAGA,0BAHA,8CAKAI,eA/BA,WA+BA,0KACAD,6CADA,UACAH,EADA,OAEAA,UAFA,iDAGA,iCAHA,8CAKAK,gBApCA,WAoCA,4KACAF,6DADA,UACAH,EADA,OAEAA,UAFA,iDAGAM,EAAAN,SACA,+CAJA,8CAMAnB,aA1CA,WA0CA,iKACA,oBADA,SAEAsB,2DAFA,UAEAH,EAFA,OAGA,oBACAA,UAJA,iDAKA,eALA,8CAOAlB,UAjDA,SAiDAyB,EAAAC,EAAAC,EAAAC,GAAA,iKACA,gBADA,SAEAX,kDAFA,UAEAC,EAFA,OAGA,gBACAH,eACAG,UALA,iDAMA,oBACA,mCAPA,gDAUAW,QAjFA,WAkFA,aAEAC,cApFA,cCtBuW,I,wBCQnWC,EAAY,eACd,EACAhD,EACAkB,GACA,EACA,KACA,WACA,MAIa,aAAA8B,E,kECnBf","file":"js/chunk-45bbb27f.79204562.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('ProposalForm',{attrs:{\"isEdit\":true,\"dateSource\":_vm.proposalInfo,\"isCouncil\":_vm.isCouncil,\"tokenInfo\":_vm.tokenInfo,\"tokenAuth\":_vm.tokenAuth,\"loadingApprove\":_vm.loadingApprove,\"loadingAdd\":_vm.loadingAdd},on:{\"approveToken\":_vm.approveToken,\"addProposal\":_vm.handleAdd}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"page\">\n      <ProposalForm\n      :isEdit=\"true\"\n      :dateSource=\"proposalInfo\"\n      :isCouncil=\"isCouncil\"\n      :tokenInfo=\"tokenInfo\"\n      :tokenAuth=\"tokenAuth\"\n      :loadingApprove=\"loadingApprove\"\n      :loadingAdd=\"loadingAdd\"\n      @approveToken=\"approveToken\"\n      @addProposal=\"handleAdd\"/>\n    </div>\n</template>\n\n<script>\nimport ProposalForm from './components/ProposalForm.vue'\nimport daoObj from '../../contracts/contractDao'\nimport tokenObj from '../../contracts/contractToken'\nimport config from '../../config/app.config'\nimport { mapState } from 'vuex'\n\nexport default {\n  name: '',\n  components: { ProposalForm },\n  data () {\n    return {\n      point: 0.000001,\n      daoAt: '',\n      isCouncil: false,\n      proposalInfo: {},\n      tokenInfo: {\n        name: '-',\n        totalSupply: 0,\n        tokenAddress: ''\n      },\n      tokenAuth: false,\n      loadingApprove: false,\n      loadingAdd: false\n    }\n  },\n  computed: {\n    ...mapState(['proposalDetail'])\n  },\n  methods: {\n    init () {\n      this.getInfo()\n    },\n    async getInfo () {\n      console.log('proposalDetail', this.proposalDetail)\n      // const info = sessionStorage.getItem('proposalDetail') || ''\n      if (!this.proposalDetail) this.$router.replace('/detail')\n      this.proposalInfo = this.proposalDetail\n      this.daoAt = this.proposalInfo.daoAt\n      this.proposalId = this.proposalInfo.index\n      this.tokenInfo.tokenAddress = this.proposalInfo.token\n      this.getIsCouncil()\n      this.getTokenInfo()\n    },\n    async getIsCouncil () {\n      const resp = await daoObj.councliAt(this.daoAt)\n      if (!resp.success) return\n      if (!resp.result) this.isCouncil = false\n      else this.isCouncil = true\n    },\n    async getTokenInfo () {\n      this.getSymbol()\n      await this.getTotalSupply()\n      this.getTokenAllance()\n    },\n    async getSymbol () {\n      const resp = await tokenObj.getSymbol(this.tokenInfo.tokenAddress)\n      if (!resp.success) return\n      this.tokenInfo.name = resp.result\n    },\n    async getTotalSupply () {\n      const resp = await tokenObj.totalSupply(this.tokenInfo.tokenAddress)\n      if (!resp.success) return\n      this.tokenInfo.totalSupply = resp.result\n    },\n    async getTokenAllance () {\n      const resp = await tokenObj.allowance(this.tokenInfo.tokenAddress, config.daoAddress)\n      if (!resp.success) return\n      const allowanceAmount = resp.result\n      this.tokenAuth = allowanceAmount >= (this.tokenInfo.totalSupply * this.point)\n    },\n    async approveToken () {\n      this.loadingApprove = true\n      const resp = await tokenObj.approve(this.tokenInfo.tokenAddress, config.daoAddress)\n      this.loadingApprove = false\n      if (!resp.success) return\n      this.tokenAuth = true\n    },\n    async handleAdd (params1, params2, mutilOption, options) {\n      this.loadingAdd = true\n      const resp = await daoObj.proposalEdit(this.daoAt, this.proposalId, params1, params2, mutilOption, options)\n      this.loadingAdd = false\n      console.log(resp)\n      if (!resp.success) return\n      this.$toast('success')\n      this.$gbUtils.handleToPage('/detail')\n    }\n  },\n  mounted () {\n    this.init()\n  },\n  beforeDestroy () {\n    // sessionStorage.removeItem('proposalDetail')\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.page {\n  padding: 0 15px 20px 15px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModifyProposal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModifyProposal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ModifyProposal.vue?vue&type=template&id=a737ca16&scoped=true&\"\nimport script from \"./ModifyProposal.vue?vue&type=script&lang=js&\"\nexport * from \"./ModifyProposal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ModifyProposal.vue?vue&type=style&index=0&id=a737ca16&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a737ca16\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModifyProposal.vue?vue&type=style&index=0&id=a737ca16&scoped=true&lang=scss&\""],"sourceRoot":""}