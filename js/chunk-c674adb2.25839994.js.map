{"version":3,"sources":["webpack:///./src/views/proposal/ApplyProposal.vue?df8f","webpack:///./src/views/proposal/ApplyProposal.vue?ae08","webpack:///src/views/proposal/ApplyProposal.vue","webpack:///./src/views/proposal/ApplyProposal.vue?a260","webpack:///./src/views/proposal/ApplyProposal.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","isCouncil","tokenInfo","tokenAuth","loadingApprove","loadingAdd","on","approveToken","handleAdd","staticRenderFns","name","components","ProposalForm","data","point","daoAt","daoInfo","token","totalSupply","methods","init","getDaoId","getIsCouncil","daoObj","resp","getDaoInfo","getTokenInfo","getSymbol","tokenObj","getTotalSupply","getTokenAllance","allowanceAmount","params1","params2","mutilOption","options","mounted","component"],"mappings":"kHAAA,W,kECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,eAAe,CAACG,MAAM,CAAC,UAAYP,EAAIQ,UAAU,UAAYR,EAAIS,UAAU,UAAYT,EAAIU,UAAU,eAAiBV,EAAIW,eAAe,WAAaX,EAAIY,YAAYC,GAAG,CAAC,aAAeb,EAAIc,aAAa,YAAcd,EAAIe,cAAc,IACxWC,EAAkB,G,wGCkBP,GACfC,QACAC,YAAAC,qBACAC,KAHA,WAIA,OACAC,WACAC,SACAd,aACAe,SACAC,UAEAf,WACAQ,SACAQ,eAEAf,aACAC,kBACAC,gBAGAc,SACAC,KADA,WAEA,iBAEAC,SAJA,WAIA,2JACA,iCACA,sCACA,iBAHA,SAIA,eAJA,OAKA,iBALA,8CAOAC,aAXA,WAWA,0KACAC,0BADA,UACAC,EADA,OAEAA,UAFA,iDAGA,SACA,eADA,eAHA,8CAMAC,WAjBA,WAiBA,0KACAF,0BADA,UACAC,EADA,OAEAA,UAFA,iDAGA,mBAHA,8CAKAE,aAtBA,WAsBA,2JACA,cACA,mBAFA,SAGA,oBAHA,8CAKAC,UA3BA,WA2BA,0KACAC,kCADA,UACAJ,EADA,OAEAA,UAFA,iDAGA,0BAHA,8CAKAK,eAhCA,WAgCA,0KACAD,oCADA,UACAJ,EADA,OAEAA,UAFA,iDAGA,iCAHA,8CAKAM,gBArCA,WAqCA,4KACAF,oDADA,UACAJ,EADA,OAEAA,UAFA,iDAGAO,GAAA,SACA,+CAJA,8CAMAxB,aA3CA,WA2CA,iKACA,oBADA,SAEAqB,kDAFA,UAEAJ,EAFA,OAGA,oBACAA,UAJA,iDAKA,eALA,8CAOAhB,UAlDA,SAkDAwB,EAAAC,EAAAC,EAAAC,GAAA,iKACA,gBADA,SAGAZ,oCAHA,UAGAC,EAHA,OAIA,gBACAA,UALA,iDAMA,oBACA,mCAPA,+CAUAY,QAhFA,WAiFA,cCpGsW,I,wBCQlWC,EAAY,eACd,EACA7C,EACAiB,GACA,EACA,KACA,WACA,MAIa,aAAA4B,E","file":"js/chunk-c674adb2.25839994.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApplyProposal.vue?vue&type=style&index=0&id=df673c36&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('ProposalForm',{attrs:{\"isCouncil\":_vm.isCouncil,\"tokenInfo\":_vm.tokenInfo,\"tokenAuth\":_vm.tokenAuth,\"loadingApprove\":_vm.loadingApprove,\"loadingAdd\":_vm.loadingAdd},on:{\"approveToken\":_vm.approveToken,\"addProposal\":_vm.handleAdd}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"page\">\n      <ProposalForm\n      :isCouncil=\"isCouncil\"\n      :tokenInfo=\"tokenInfo\"\n      :tokenAuth=\"tokenAuth\"\n      :loadingApprove=\"loadingApprove\"\n      :loadingAdd=\"loadingAdd\"\n      @approveToken=\"approveToken\"\n      @addProposal=\"handleAdd\"/>\n    </div>\n</template>\n\n<script>\nimport ProposalForm from './components/ProposalForm.vue'\nimport daoObj from '../../contracts/contractDao'\nimport tokenObj from '../../contracts/contractToken'\nimport config from '../../config/app.config'\n\nexport default {\n  name: '',\n  components: { ProposalForm },\n  data () {\n    return {\n      point: 0.000001,\n      daoAt: '',\n      isCouncil: false,\n      daoInfo: {\n        token: ''\n      },\n      tokenInfo: {\n        name: '-',\n        totalSupply: 0\n      },\n      tokenAuth: true,\n      loadingApprove: false,\n      loadingAdd: false\n    }\n  },\n  methods: {\n    init () {\n      this.getDaoId()\n    },\n    async getDaoId () {\n      this.daoAt = this.$route.query.daoAt || ''\n      if (!this.daoAt) this.$router.replace('/detail')\n      this.getIsCouncil()\n      await this.getDaoInfo()\n      this.getTokenInfo()\n    },\n    async getIsCouncil () {\n      const resp = await daoObj.councliAt(this.daoAt)\n      if (!resp.success) return\n      if (!resp.result) this.isCouncil = false\n      else this.isCouncil = true\n    },\n    async getDaoInfo () {\n      const resp = await daoObj.daoDetail(this.daoAt)\n      if (!resp.success) return\n      this.daoInfo = resp.result\n    },\n    async getTokenInfo () {\n      this.getSymbol()\n      this.getTotalSupply()\n      await this.getTokenAllance()\n    },\n    async getSymbol () {\n      const resp = await tokenObj.getSymbol(this.daoInfo.token)\n      if (!resp.success) return\n      this.tokenInfo.name = resp.result\n    },\n    async getTotalSupply () {\n      const resp = await tokenObj.totalSupply(this.daoInfo.token)\n      if (!resp.success) return\n      this.tokenInfo.totalSupply = resp.result\n    },\n    async getTokenAllance () {\n      const resp = await tokenObj.allowance(this.daoInfo.token, config.daoAddress)\n      if (!resp.success) return\n      const allowanceAmount = +resp.result\n      this.tokenAuth = allowanceAmount >= (this.tokenInfo.totalSupply * this.point)\n    },\n    async approveToken () {\n      this.loadingApprove = true\n      const resp = await tokenObj.approve(this.daoInfo.token, config.daoAddress)\n      this.loadingApprove = false\n      if (!resp.success) return\n      this.tokenAuth = true\n    },\n    async handleAdd (params1, params2, mutilOption, options) {\n      this.loadingAdd = true\n      \n      const resp = await daoObj.proposalAdd(this.daoAt, params1, params2, mutilOption, options)\n      this.loadingAdd = false\n      if (!resp.success) return\n      this.$toast('success')\n      this.$gbUtils.handleToPage('/detail')\n    }\n  },\n  mounted () {\n    this.init()\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.page {\n  padding: 0 15px 20px 15px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApplyProposal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApplyProposal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ApplyProposal.vue?vue&type=template&id=df673c36&scoped=true&\"\nimport script from \"./ApplyProposal.vue?vue&type=script&lang=js&\"\nexport * from \"./ApplyProposal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ApplyProposal.vue?vue&type=style&index=0&id=df673c36&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"df673c36\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}